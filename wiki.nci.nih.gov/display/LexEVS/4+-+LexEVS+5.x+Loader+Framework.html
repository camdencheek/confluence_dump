Contents of this Page
<ul>
  <li>
    <a href="#id-4LexEVS5.xLoaderFramework-Introduction" rel="nofollow">
      Introduction
    </a>
    <ul>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-DocumentPurpose" rel="nofollow">
          Document Purpose
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-LoaderFrameworkBackgroundandEnhancements" rel="nofollow">
          Loader Framework Background and Enhancements
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Scope" rel="nofollow">
          Scope
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Architecture" rel="nofollow">
          Architecture
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Assumptions" rel="nofollow">
          Assumptions
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Dependencies" rel="nofollow">
          Dependencies
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Issues" rel="nofollow">
          Issues
        </a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#id-4LexEVS5.xLoaderFramework-DevelopmentandBuildEnvironment" rel="nofollow">
      Development and Build Environment
    </a>
    <ul>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-ThirdPartyTools" rel="nofollow">
          Third Party Tools
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-LoaderFrameworkCode" rel="nofollow">
          Loader Framework Code
        </a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#id-4LexEVS5.xLoaderFramework-HowtoUsetheLoaderFramework:ARoadmap" rel="nofollow">
      How to Use the Loader Framework: A Roadmap
    </a>
    <ul>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Spring" rel="nofollow">
          Spring
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-ItemReader/ItemProcessor" rel="nofollow">
          ItemReader/ItemProcessor
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-MavenSetup" rel="nofollow">
          Maven Set up
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-EclipseProjectSetup" rel="nofollow">
          Eclipse Project Set up
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-ConfigureyourSpringConfig(myLoader.xml)" rel="nofollow">
          Configure your Spring Config (myLoader.xml)
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Beans" rel="nofollow">
          Beans
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-KeyDirectories" rel="nofollow">
          Key Directories
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Algorithms" rel="nofollow">
          Algorithms
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-BatchProcesses" rel="nofollow">
          Batch Processes
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-ErrorHandling" rel="nofollow">
          Error Handling
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-DatabaseChanges" rel="nofollow">
          Database Changes
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Client" rel="nofollow">
          Client
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-JSP/HTML" rel="nofollow">
          JSP/HTML
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Servlet" rel="nofollow">
          Servlet
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-SecurityIssues" rel="nofollow">
          Security Issues
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Performance" rel="nofollow">
          Performance
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-Internationalization" rel="nofollow">
          Internationalization
        </a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#id-4LexEVS5.xLoaderFramework-Installation/Packaging" rel="nofollow">
      Installation / Packaging
    </a>
  </li>
  <li>
    <a href="#id-4LexEVS5.xLoaderFramework-Migration" rel="nofollow">
      Migration
    </a>
  </li>
  <li>
    <a href="#id-4LexEVS5.xLoaderFramework-Testing" rel="nofollow">
      Testing
    </a>
  </li>
  <li>
    <a href="#id-4LexEVS5.xLoaderFramework-CustomLoaderFeasibilityReportandRecommendation" rel="nofollow">
      Custom Loader Feasibility Report and Recommendation
    </a>
    <ul>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-PersistenceLayerFeasibility" rel="nofollow">
          Persistence Layer Feasibility
        </a>
      </li>
      <li>
        <a href="#id-4LexEVS5.xLoaderFramework-LoaderFrameworkFeasibilty" rel="nofollow">
          Loader Framework Feasibilty
        </a>
      </li>
    </ul>
  </li>
</ul>
<h2 id="id-4LexEVS5.xLoaderFramework-Introduction">
  Introduction
</h2>
This document is a section of the
<a href="https://wiki.nci.nih.gov/pages/viewpage.action?pageId=62427498" rel="nofollow">
  Loader Guide
</a>
. It is new in LexEVS v5.1.
<h3 id="id-4LexEVS5.xLoaderFramework-DocumentPurpose">
  Document Purpose
</h3>
This document provides the detailed design and implementation of the Loader Framework Extension. It is the goal of this document to provide enough information to enable application developers to create custom loaders. This document assumes the developer is already familiar with the LexEVS software.
<h3 id="id-4LexEVS5.xLoaderFramework-LoaderFrameworkBackgroundandEnhancements">
  Loader Framework Background and Enhancements
</h3>
Previous versions of LexEVS software has provided a set of loaders within an existing legacy framework which served LexEVS developers well over many years. But as LexEVS has gained users, and requests for new loaders have grown, it was decided to create a new loader framework. Specifically, this development work addresses &#34;TASK 6 - IMPROVE LEXEVS LOADING FRAMEWORK&#34; in the National Cancer Institute (NCI) Statement of Work (SOW) document (reference ?????).

The LexEVS v5.1 loader framework meets these emerging needs compared to the loader framework of previous versions:
<ul>
  <li>
    is easier to extend
  </li>
  <li>
    provides improved performance
  </li>
  <li>
    enables dynamic loading of new loaders
  </li>
  <li>
    leverages proven open source components, such as Spring Batch and Hibernate
  </li>
</ul>
Also, the new framework is completely independent of existing loader code, so there is no impact to existing loaders.
<h3 id="id-4LexEVS5.xLoaderFramework-Scope">
  Scope
</h3>
The LexEVS v5.1 Loader Framework provides a way for LexEVS developers to write new loaders and have them recognized dynamically by the LexEVS code. Also the framework provides help to loader developers in the form of utility classes and interfaces.
<h3 id="id-4LexEVS5.xLoaderFramework-Architecture">
  Architecture
</h3>
The LexEVS v5.1 Loader Framework extends the functionality of LexEVS 5.0. For more information on LexBIG, see
<a href="https://wiki.nci.nih.gov/pages/viewpage.action?pageId=62427415" rel="nofollow">
  LexEVS 5.0
</a>
.

The image below shows the major components of the Loader Framework.
(A) A hypothetical new loader in relation to the loader framework, and what expected API usage would be.
(B) Ideally, the new loader can make most if its API calls through the utilities provided by the Loader Framework API.
(C) Some work will need to be done with Spring (C) such as configuration of a Spring config file.
(D and E) It may or may not be necessary for a loader to use Hibernate or the LexBIG API. Again, the hope is that much of the work a new loader may need to do can be accomplished by the Loader Framework API.

The Loader Framework utilizes Spring Batch for managing its Java objects to improve performance and Hibernate provides the mapping to the LexGrid database.
<img alt="image showing the major components of the Loader Framework as described above" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/LexEVS/4%20-%20LexEVS%205.x%20Loader%20Framework/LexEVS_5.1_Loader_image003.gif?api=v2">
<h3 id="id-4LexEVS5.xLoaderFramework-Assumptions">
  Assumptions
</h3>
None
<h3 id="id-4LexEVS5.xLoaderFramework-Dependencies">
  Dependencies
</h3>
<ul>
  <li>
    This Loader Framework requires LexEVS release 5.0 or above.
  </li>
  <li>
    Development systems are required to install the Sun Java Development Kit (SDK) or Java Runtime Environment (JRE) version 1.5.0_11 or above.
  </li>
  <li>
    Maven 2.1 or greater.
  </li>
  <li>
    For software and hardware dependencies for the system hosting the LexEVS runtime, refer to
    <a href="https://wiki.nci.nih.gov/pages/viewpage.action?pageId=62427420" rel="nofollow">
      Installation and downloads
    </a>
    .
  </li>
</ul>
<h3 id="id-4LexEVS5.xLoaderFramework-Issues">
  Issues
</h3>
None
<h2 id="id-4LexEVS5.xLoaderFramework-DevelopmentandBuildEnvironment">
  Development and Build Environment
</h2>
<h3 id="id-4LexEVS5.xLoaderFramework-ThirdPartyTools">
  Third Party Tools
</h3>
<ul>
  <li>
    Spring: A lightweight open-source application framework.
    <ul>
      <li>
        Spring: see
        <a href="http://www.springsource.com/" rel="nofollow">
          http://www.springsource.com/
        </a>
      </li>
      <li>
        Spring Batch: see
        <a href="http://static.springsource.org/spring-batch/" rel="nofollow">
          http://static.springsource.org/spring-batch/
        </a>
      </li>
      <li>
        Sprint Batch Reference: see
        <a href="http://static.springsource.org/spring-batch/reference/html/index.html" rel="nofollow">
          http://static.springsource.org/spring-batch/reference/html/index.html
        </a>
      </li>
    </ul>
  </li>
  <li>
    Hibernate: An open source Java persistence framework; see
    <a href="https://www.hibernate.org/" rel="nofollow">
      https://www.hibernate.org/
    </a>
  </li>
  <li>
    Maven: Apache build manager for Java projects; see
    <a href="http://maven.apache.org/" rel="nofollow">
      http://maven.apache.org/
    </a>
  </li>
  <li>
    Eclipse: An Open Source IDE. See
    <a href="http://www.eclipse.org/" rel="nofollow">
      http://www.eclipse.org/
    </a>
  </li>
</ul>
<h3 id="id-4LexEVS5.xLoaderFramework-LoaderFrameworkCode">
  Loader Framework Code
</h3>
The Loader Framework code is available in the NCI Subversion (SVN) repository. It is comprised of three Framework projects. Also at the time of this writing there are three projects in the repository that utilize the Loader Framework.

Loader Framework Projects
<ul>
  <li>
    PersistanceLayer: a Hibernate connector to the LexBIG database
  </li>
  <li>
    Loader-framework: a framework that sets up build information for Maven
  </li>
  <li>
    Loader-framework-core: a framework that contains all the interfaces and utilities; also contains an extendable class &#34;AbstractSpringBatchLoader&#34; that all new Loaders should extend
  </li>
</ul>
Loader Proejcts Using the New Framework
<ul>
  <li>
    abstract-rrf-loader: a holder for common rrf-based loader code
  </li>
  <li>
    meta-loader: a new loader to read the NCI MetaThesaurus
  </li>
  <li>
    umls-loader: a loader for reading Unified Medical Language System (UMLS) content
  </li>
</ul>
Maven
The above projects utilize Maven for build and dependency management. Obtain the Maven plugin for Eclipse at
<a href="http://m2eclipse.codehaus.org" rel="nofollow">
  http://m2eclipse.codehaus.org
</a>
<h2 id="id-4LexEVS5.xLoaderFramework-HowtoUsetheLoaderFramework:ARoadmap">
  How to Use the Loader Framework: A Roadmap
</h2>
You can write a loader that uses the Loader Framework. The loader would follow this general process:
<ol>
  <li>
    Read the raw data from the file into intermediate data structures, such as a user-defined ICD9SourceObject object.
  </li>
  <li>
    Process the user-defined objects into LexGrid model objects.
  </li>
  <li>
    Write the data in the LexGrid objects to the database.
  </li>
</ol>
An example may help in understanding the Framework. Our discussion will refer to the illustration below. Let&#39;s say we are writing a loader to load the ICD-9-CM codes and their descriptions, which are contained in a text file. We know we&#39;ll need a data structure to hold the data after we&#39;ve read it so we have a class:

&lt;source&gt;
ICD9SourceObject \{
String id;
String descr;
String getId() \{ return id; \}
\}
&lt;/source&gt;



The Loader Framework uses Spring Batch to manage the reading, processing, and writing of data. Spring provides classes and interfaces to help do this work, and the Loader Framework also provides utilities to help loader developers. In our example, illustrated below, we will write a class that will use the Spring ItemReader interface. It will take a line of text and return an ICD9SourceObject (shown as 1 and 2). Next we&#39;ll want to process that data into a LexEVS object such as an Entity object. So we&#39;ll write class that implements Spring&#39;s ItemProcessor interface. It will take our ICD9SourceObject and output a LexEVS Entity object (shown as 3 and 4). Finally, we&#39;ll want to write the data to the database (shown as 5). Note that the LexEVS model objects provided in the Loader Framework are generated by Hibernate and utilize Hibernate to write the data to the database. This will free us from having to write SQL.
<img alt="diagram illustrating the previous paragraph" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/LexEVS/4%20-%20LexEVS%205.x%20Loader%20Framework/LexEVS_5.1_Loader_image004.jpg?api=v2">
<h3 id="id-4LexEVS5.xLoaderFramework-Spring">
  Spring
</h3>
Configure Spring to be aware of your objects and to manage them. This is done via an XML configuration file. More details on the Spring config file arebelow.
<h3 id="id-4LexEVS5.xLoaderFramework-ItemReader/ItemProcessor">
  ItemReader/ItemProcessor
</h3>
Either write a class implementing this interface or use one of the Spring helper classes that already implement this interface. If you use one of the Spring classes, you may need to provide one of your own helper classes to construct your internal data structure object, such as ICD9SourceObject. Provide it to the Spring object via a setProperty call configured in the Spring config file.
<h3 id="id-4LexEVS5.xLoaderFramework-MavenSetup">
  Maven Set up
</h3>
The projects containing the Loader Framework (PersistanceLayer , loader-framework , and loader-framework-core) use Maven for dependency management and build. You will still use Eclipse as your IDE and code repository, but you will need to install a Maven plugin for Eclipse.
<ol>
  <li>
    Install the Maven plugin for Eclipse, which can be found at:
    <a href="http://m2eclipse.sonatype.org/" rel="nofollow">
      http://m2eclipse.sonatype.org/
    </a>
    .
  </li>
  <li>
    Provide a URL and userid/password to a Maven repository on a server (which manages your dependencies or dependent jar files). Ours here at Mayo Clinic is:
    <a href="http://bmidev4:8282/nexus-webapp-1.3.3/index.html" rel="nofollow">
      http://bmidev4:8282/nexus-webapp-1.3.3/index.html
    </a>
    .
  </li>
  <li>
    Import the Loader Framework classes from SVN.
  </li>
  <li>
    You will most likely see build errors about missing jars. Resolve those by right clicking on the project with errors, select Maven&#39;, and Resolve Dependencies. This will pull the dependant jars from the Maven repository into your local environment.
  </li>
  <li>
    To build a Maven project, right click on the project, select Maven, then select assembly:assembly.
  </li>
</ol>
<h3 id="id-4LexEVS5.xLoaderFramework-EclipseProjectSetup">
  Eclipse Project Set up
</h3>
When you create a new loader project in Eclipse, it is recommended you follow the Maven directory structure. By following this convention, Maven can build the project and find the test cases.

The following diagram is from the Maven documentation:
<img alt="image illustrating the Maven directory structure" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/LexEVS/4%20-%20LexEVS%205.x%20Loader%20Framework/LexEVS_5.1_Eclipse_Project.gif?api=v2">
For more information on the Maven project, see
<a href="http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html" rel="nofollow">
  http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html
</a>
<h3 id="id-4LexEVS5.xLoaderFramework-ConfigureyourSpringConfig(myLoader.xml)">
  Configure your Spring Config (myLoader.xml)
</h3>
Spring is a lightweight bean management container; among other things, it contains a batch function that is utilized by the Loader Framework. A loader using the framework will need to work closely with Spring Batch. The way it does that is through Spring&#39;s configuration file where you configure beans (your loader code) and how the loader code should be utilized by Spring Batch (by configuring a Job, Step, and other Spring Batch stuff in the spring config file). Here is sample code:


&lt;source&gt;
&lt;job id=&#34;ioSampleJob&#34;&gt;
&lt;step name=&#34;step1&#34;&gt;
&lt;tasklet
&lt;chunk reader=&#34;fooReader&#34; processor=&#34;fooProcessor&#34; writer=&#34;compositeItemWriter&#34; commit-interval=&#34;100&#34;&gt;
&lt;/chunk&gt;
&lt;/tasklet&gt;
&lt;/step&gt;
&lt;/job&gt;

&lt;bean id= &#34;compositeItemWriter&#34; class=&#34;...compositeItemWriter&#34;&gt;
{panel}
&lt;property name=&#34;delegate&#34; ref=&#34;barWriter&#34; /&gt;
{panel}
&lt;/bean&gt;

&lt;bean id=&#34;barWriter&#34; class=&#34;...barWriter&#34; /&gt;
&lt;/source&gt;



What follows is a brief overview of those tags related to the LoaderFramework. For more detail please see the Spring documentation at
<a href="http://static.springsource.org/spring-batch/reference/html/index.html" rel="nofollow">
  http://static.springsource.org/spring-batch/reference/html/index.html
</a>
.
<h3 id="id-4LexEVS5.xLoaderFramework-Beans">
  Beans
</h3>
The beans:beans tag is the all-encompassing tag. You define all your other tags in it. You can also define an import within this tag to import an external Spring config file. (Import is not shown in the sample image above.)

Bean

Use these tags, beans:bean&#39;, to define the beans to be managed by the Spring container by specifying the packaged qualified class name. You can also specify inititialization values and set bean properties within these tags.


&lt;source&gt;
&lt;beans:bean id=&#34;umlsCuiPropertyProcessor&#34; parent=&#34;umlsDefaultPropertyProcessor&#34; class=&#34;org.lexgrid.loader.processor.EntityPropertyProcessor&#34;&gt;
&lt;beans:property name=&#34;propertyResolver&#34; ref=&#34;umlsCuiPropertyResolver&#34; /&gt;
&lt;/beans:bean&gt;
&lt;/source&gt;



Job

The job tag is the main unit of work. The job is comprised of one or more steps that define the work to be done. Other advanced and interesting things can be done within the Job such as using split and flow tags to indicate work that can be done in parellel steps to improve performance.


&lt;source&gt;
&lt;job id=&#34;umlsJob&#34; restartable=&#34;true&#34;&gt;
&lt;step id=&#34;populateStagingTable&#34; next=&#34;loadHardcodedValues&#34; parent=&#34;stagingTablePopulatorStepFactory&#34;/&gt;
...
&lt;/Source&gt;



Step

One or more step tags make up a job and can vary from simple to complex in content. Among other things, you can specify which step should be executed next.

Tasklet

You can do anything you want within a Tasklet, such as sending an email or a LexBIG function such as indexing. You are not limited to just database operations. The Spring documentation also has this to say about Tasklets:

The Tasklet is a simple interface that has one method, execute, which will be a called repeatedly
by the TaskletStep until it either returns RepeatStatus.FINISHED or throws an exception to signal
a failure. Each call to the Tasklet is wrapped in a transaction.

Chunk

Spring documentation says it best:

Spring Batch uses a &#34;Chunk-Oriented&#34; processing style within its most common implementation. Chunk-
oriented processing refers to reading the data one at a time, and creating &#34;chunks&#34; that will be
written out, within a transaction boundary. One item is read in from an ItemReader, handed to an
ItemWriter, and aggregated. Once the number of items read equals the commit interval, the entire
chunk is written out via the ItemWriter, and then the transaction is committed.

Reader

An attribute of the chunk tag. Here is the class that you defined implementing the Spring ItemReader interface to read data from your data file and create domain-specific objects.

Processor

Another attribute of the chunk tag. This is the class that implements the ItemProcessor interface where other manipulations of the domain objects take place. In the case of the Loader Framework, we create LexGrid model objects from the domain objects so that they can be written to the database via Hibernate. Note that this is not a required attribute. In theory, if you had a data source from which you could read such that you could create LexBIG objects immediately, you would not need a processor. In practice this would most likely not be the case, but rather you need to work with the data to get it into LexBIG objects.

Writer

Attribute of the chunk tag. This class will implement the Spring interface ItemWriter. In the case of the Loader Framework, these classes have been written for you. They are the LexGrid model objects that use Hibernate to write to the database.
<h3 id="id-4LexEVS5.xLoaderFramework-KeyDirectories">
  Key Directories
</h3>
Below is an image of the loader-framework-core project in Eclipse, which shows the key directories of the Loader Framework. The following is a summary of the contents of those directories.
<img alt="image of loader-framework-core project in Eclipse" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/LexEVS/4%20-%20LexEVS%205.x%20Loader%20Framework/LexEVS_5.1_Loader_image006.jpg?api=v2">
<table>
  <tbody>
    <tr>
      <th>
        Directory
      </th>
      <th>
        Summary
      </th>
    </tr>
    <tr>
      <td>
        connection
      </td>
      <td>
        Connect to LexBIG and do LexBIG tasks such as register and activate
      </td>
    </tr>
    <tr>
      <td>
        constants
      </td>
      <td>
        Assorted constants
      </td>
    </tr>
    <tr>
      <td>
        dao
      </td>
      <td>
        Access to the LexBIG database
      </td>
    </tr>
    <tr>
      <td>
        data
      </td>
      <td>
        Directly related to data going into the LexBIG database tables
      </td>
    </tr>
    <tr>
      <td>
        database
      </td>
      <td>
        Database-specific tasks not related to data, such as finding out the database type (MySQL, Oracle)
      </td>
    </tr>
    <tr>
      <td>
        fieldsetter
      </td>
      <td>
        Spring-related classes for helping to write to the database
      </td>
    </tr>
    <tr>
      <td>
        lexbigadmin
      </td>
      <td>
        Common tasks for LexBIG to perform, such as indexing
      </td>
    </tr>
    <tr>
      <td>
        listener
      </td>
      <td>
        Listeners you can attach to a load so that the code will execute at certain points in the load, such as a cleanup listener that runs when the load is finished, or a setup listener, etc.
      </td>
    </tr>
    <tr>
      <td>
        logging
      </td>
      <td>
        Access to the LexBIG logger
      </td>
    </tr>
    <tr>
      <td>
        processor
      </td>
      <td>
        Important directory: classes to which you can pass a domain-specific object and which will return a LexBIG object
      </td>
    </tr>
    <tr>
      <td>
        properties
      </td>
      <td>
        Code used internally by the Loader Framework
      </td>
    </tr>
    <tr>
      <td>
        reader
      </td>
      <td>
        Readers and reader-related tools for loader developers
      </td>
    </tr>
    <tr>
      <td>
        rowmapper
      </td>
      <td>
        Classes for reading from a database; currently experimental code
      </td>
    </tr>
    <tr>
      <td>
        setup
      </td>
      <td>
        Loader developers should not need to dive into this directory. Classes such as JobRepositoryManager that help Spring do its work; as Spring hums along it keeps tables of its internal workings.
      </td>
    </tr>
    <tr>
      <td>
        staging
      </td>
      <td>
        Helper classes to use if your loader needs to load data to the database temporarlily
      </td>
    </tr>
    <tr>
      <td>
        wrappers
      </td>
      <td>
        Helper classes and data structures such as a Code/CodingScheme class
      </td>
    </tr>
    <tr>
      <td>
        writer
      </td>
      <td>
        Miscellaneous classes that write to the database. These are not the same classes you would use in your loader, i.e the LexBIG model objects that use Hibernate. Those classes are contained in the PersistanceLayer project (shown below). It is by using those classes in the PersistenceLayer that you let the Loader Framework do some of the heavy lifting for you.
      </td>
    </tr>
  </tbody>
</table>
<img src="https://wiki.nci.nih.gov/download/attachments/embedded-page/LexEVS/4%20-%20LexEVS%205.x%20Loader%20Framework/LexEVS_5.1_Loader_image007.gif?api=v2">
<h3 id="id-4LexEVS5.xLoaderFramework-Algorithms">
  Algorithms
</h3>
None
<h3 id="id-4LexEVS5.xLoaderFramework-BatchProcesses">
  Batch Processes
</h3>
None
<h3 id="id-4LexEVS5.xLoaderFramework-ErrorHandling">
  Error Handling
</h3>
Spring Batch gives the Loader Framework some degree of recovery from errors. Like the other features of Spring, error handling is something you need to configure in the Spring config file. Basically, Spring will keep track of the steps it has executed and make note of any step that has failed. Those failed steps can be re-run at a later time. The Spring documentation provides additional information on this function. See
<a href="http://static.springsource.org/spring-batch/reference/html/configureStep.html" rel="nofollow">
  http://static.springsource.org/spring-batch/reference/html/configureStep.html
</a>
and
<a href="http://static.springsource.org/spring-batch/reference/html/configureJob.html" rel="nofollow">
  http://static.springsource.org/spring-batch/reference/html/configureJob.html
</a>
.
<h3 id="id-4LexEVS5.xLoaderFramework-DatabaseChanges">
  Database Changes
</h3>
None
<h3 id="id-4LexEVS5.xLoaderFramework-Client">
  Client
</h3>
Loaders written to use the new framework will be called via the command line or script. Currently, the LexBIG GUI does not provide a framework to dynamically load extendable GUI components.
<h3 id="id-4LexEVS5.xLoaderFramework-JSP/HTML">
  JSP/HTML
</h3>
None
<h3 id="id-4LexEVS5.xLoaderFramework-Servlet">
  Servlet
</h3>
None
<h3 id="id-4LexEVS5.xLoaderFramework-SecurityIssues">
  Security Issues
</h3>
None
<h3 id="id-4LexEVS5.xLoaderFramework-Performance">
  Performance
</h3>
Spring can accommodate parallel processing to enhance performance. The Spring documentation provides a good discussion of this topic. See
<a href="http://static.springsource.org/spring-batch/reference/html/scalability.html" rel="nofollow">
  http://static.springsource.org/spring-batch/reference/html/scalability.html
</a>
.
<h3 id="id-4LexEVS5.xLoaderFramework-Internationalization">
  Internationalization
</h3>
Not internationalized
<h2 id="id-4LexEVS5.xLoaderFramework-Installation/Packaging">
  Installation / Packaging
</h2>
The Loader Framework is packaged as a LexBIG extension and thus is not included in the LexBIG jar
<h2 id="id-4LexEVS5.xLoaderFramework-Migration">
  Migration
</h2>
None
<h2 id="id-4LexEVS5.xLoaderFramework-Testing">
  Testing
</h2>
Automated tests are run via Maven. As mentioned earlier, the projects containing the Loader Framework code are configured to work with Maven. The illustration below shows the PersistenceLayer project and its standard Maven layout. Notice the structure of the test code mirrors the structure of the application code. To run the automated test in our Eclipse environment, we select the project, right click, select Run As and select Maven test. Maven does the rest.
<img alt="image of directories in the PersistenceLayer project and associated Maven layout" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/LexEVS/4%20-%20LexEVS%205.x%20Loader%20Framework/LexEVS_5.1_Loader_image008.jpg?api=v2">
Test Guidelines

The test cases are also integrated into the LexBIG 5.1 build environment and are run with each build.

Test Cases

See System Testing

Test Results

See System Testing
<h2 id="id-4LexEVS5.xLoaderFramework-CustomLoaderFeasibilityReportandRecommendation">
  Custom Loader Feasibility Report and Recommendation
</h2>
<h3 id="id-4LexEVS5.xLoaderFramework-PersistenceLayerFeasibility">
  Persistence Layer Feasibility
</h3>
The Persistence Layer enables LexEVS to have a single access point to the underlying database. This has several advantages:
<ul>
  <li>
    The DAO is implemented as an Interface, not a concrete class. We can implement this interface with Hibernate, JDBC, Ibatis, or any other Persistence tool or framework.
  </li>
  <li>
    All loaders can now share a single entry point to the database, and are not limited by memory constraints as some of the EMF persistence was.
  </li>
  <li>
    Connection Pooling and management is abstracted from the code and pluggable. Data source implementations may be switched and Connection Pooling may be configured without recompiling code.
  </li>
  <li>
    Transactions may be defined programmatically via AOP interceptors.
  </li>
</ul>
As LexEVS moves forward, the Persistence Layer is also flexible enough to play a part in the runtime Query API. With this, the runtime and loader code would be able to share a common Data Access Layer - we would then have a true DAO Layer.
<h3 id="id-4LexEVS5.xLoaderFramework-LoaderFrameworkFeasibilty">
  Loader Framework Feasibilty
</h3>
The Loader Framework has been implemented for two loaders: the UMLS single ontology loader and the NCI Metathesaurus loader. These loaders that implement the Loader Framework simply must define the READ and TRANSFORMATION mechanisms for the load, as well as load order and flow. All common details of loading to LexEVS will be dealt with by the Loader Framework and will not have to be implemented. Tools exist for:
<ul>
  <li>
    Lucene indexing
  </li>
  <li>
    registering CodingSchemes
  </li>
  <li>
    changing CodingScheme status (to ACTIVE, INACTIVE, etc)
  </li>
  <li>
    building the Transitivity Closure table
  </li>
  <li>
    adding supported attributes
  </li>
  <li>
    detecting database type
  </li>
  <li>
    staging temporary data to the database
  </li>
  <li>
    restarting failed loads
  </li>
  <li>
    integrating with LexEVS logging
  </li>
  <li>
    detecting and handling root nodes
  </li>
  <li>
    additional common LexEVS load-related tasks
  </li>
</ul>
Also, to aid in transformation, basic building blocks have been created that users may extend, such as:
<ul>
  <li>
    processors for all of LexEVS Model Objects
  </li>
  <li>
    various list processors
  </li>
  <li>
    grouping processors
  </li>
  <li>
    auto-supported attribute adding processors
  </li>
  <li>
    several basic resolvers to extract LexEVS Specific data from the source
  </li>
  <li>
    various other processors for specialized tasks
  </li>
</ul>
Several Utilities are also available for reading and writing, such as:
<ul>
  <li>
    group readers
  </li>
  <li>
    group writers
  </li>
  <li>
    writers configurable to skip certain records
  </li>
  <li>
    partitionable readers to break up large source files
  </li>
  <li>
    error-checking readers and Writers
  </li>
  <li>
    a validating framework for inspecting content before it is inserted into the database
  </li>
</ul>