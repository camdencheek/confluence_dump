NCI uses Okta for authentication and authorization services for the CTRP applications and APIs. This page describes the tasks required to obtain the proper authorization to use the CTRP API. For any questions or support contact
<a href="mailto:CTRP_support@nih.gov" rel="nofollow">
  CTRP_support@nih.gov
</a>
.
<h3 id="NCICTRPAPIAuthenticationGuide-1.CreateNCICTRPuseraccount">
  1. Create NCI CTRP user account
</h3>
All users are required to have a valid Okta CTRP user account to access CTRP applications (CTRP Registration and CTRP Accrual) and use the CTRP API. For instructions on requesting an Okta CTRP account, refer to the following:
<a href="https://wiki.nci.nih.gov/display/CTRP/Creating+New+NCI+CTRP+User+Accounts" rel="nofollow">
  Creating New NCI CTRP User Accounts
</a>
.
<h3 id="NCICTRPAPIAuthenticationGuide-2.ObtainOktaClientIDandClientSecret">
  2. Obtain Okta Client ID and Client Secret
</h3>
Once your Okta CTRP user account has been created, contact
<a href="mailto:CTRP_support@nih.gov" rel="nofollow">
  CTRP_support@nih.gov
</a>
 to request authorization to use the CTRP APIs. CTRP Support will review the request and, if approved, will generate a Client ID and Client Secret associated with your account and provide these key values to you. The Client ID and Client secret are required parameters to generate an Okta access token.
<h3 id="NCICTRPAPIAuthenticationGuide-3.GenerateOktaaccesstoken">
  3. Generate Okta access token
</h3>
All service endpoints require Okta access token authentication. To generate an Okta access token, a request must be made to the environment service endpoint using a valid Client ID and Client Secret. See below for additional details on how to construct the access token request.
<h4 id="NCICTRPAPIAuthenticationGuide-Method:POST">
  Method: POST
</h4>
<h4 id="NCICTRPAPIAuthenticationGuide-ServiceEndpoints:">
  Service Endpoints:
</h4>
<table>
  <colgroup>
    <col/>
    <col/>
  </colgroup>
  <tbody>
    <tr>
      <td>
        Stage
      </td>
      <td>
        https://bioappdev.okta.com/oauth2/aus478s3eb0x3du23297/v1/token
      </td>
    </tr>
    <tr>
      <td colspan="1">
        Production
      </td>
      <td colspan="1">
        <a href="https://bioappdev.okta.com/oauth2/aus8jhc6kdbWPrwYa297/v1/token" rel="nofollow">
          https://bioappdev.okta.com/oauth2/aus8jhc6kdbWPrwYa297/v1/token
        </a>
      </td>
    </tr>
  </tbody>
</table>
<h4 id="NCICTRPAPIAuthenticationGuide-Headers">
  Headers
</h4>
<table>
  <colgroup>
    <col/>
    <col/>
  </colgroup>
  <tbody>
    <tr>
      <td>
        Content-Type
      </td>
      <td>
        application/x-www-form-urlencoded
      </td>
    </tr>
    <tr>
      <td>
        Accept
      </td>
      <td>
        application/json
      </td>
    </tr>
  </tbody>
</table>
<h4 id="NCICTRPAPIAuthenticationGuide-Parameters:">
  Parameters:
</h4>
<table>
  <colgroup>
    <col/>
    <col/>
  </colgroup>
  <tbody>
    <tr>
      <td>
        grant_type
      </td>
      <td>
        client_credentials
      </td>
    </tr>
  </tbody>
</table>
<h4 id="NCICTRPAPIAuthenticationGuide-Authorization:">
  Authorization:
</h4>
<table>
  <colgroup>
    <col/>
    <col/>
  </colgroup>
  <tbody>
    <tr>
      <td colspan="1">
        Authorization Type
      </td>
      <td colspan="1">
        Basic
      </td>
    </tr>
    <tr>
      <td>
        Username
      </td>
      <td>
        Client ID generated by CTRP Support for the user account
      </td>
    </tr>
    <tr>
      <td>
        Password
      </td>
      <td>
        Client Secret generated by CTRP Support for the user account
      </td>
    </tr>
  </tbody>
</table>
<h4 id="NCICTRPAPIAuthenticationGuide-Response:">
  Response:
</h4>
{&#34;token_type&#34;:&#34;Bearer&#34;,&#34;expires_in&#34;:&lt;seconds&gt;,&#34;access_token&#34;:&lt;accessToken&gt;}The access token expiration period is set per the following:Stage: 8 Hours (28800 seconds)Production: 4 Hours (14400 seconds)
<h3 id="NCICTRPAPIAuthenticationGuide-4.CallRESTServicewithBearerAuthentication">
  4. Call REST Service with Bearer Authentication
</h3>
Once the access token has been generated, it will need to be included in the &#39;Authorization: Bearer&#39; parameter when submitting API requests. The following example uses the accrual-services URL in the Stage environment and lists the required header and parameters values.
<h4 id="NCICTRPAPIAuthenticationGuide-Method:PUT">
  Method: PUT
</h4>
<h4 id="NCICTRPAPIAuthenticationGuide-ServiceEndpoint:">
  Service Endpoint:
</h4>
<table>
  <colgroup>
    <col/>
    <col/>
  </colgroup>
  <tbody>
    <tr>
      <td>
        Stage
      </td>
      <td>
        https://trials-int.nci.nih.gov/accrual-services/trials/{idType}/{trialId}/sites/po/{id}
      </td>
    </tr>
    <tr>
      <td colspan="1">
        idType
      </td>
      <td colspan="1">
        Type of identifier you want to use to identify a study in CTRP. Possible values: pa, nci, ctep, dcp
      </td>
    </tr>
    <tr>
      <td colspan="1">
        trialID
      </td>
      <td colspan="1">
        Trial identifier value itself
      </td>
    </tr>
    <tr>
      <td colspan="1">
        id
      </td>
      <td colspan="1">
        PO identifier of the organization that is the site on the study
      </td>
    </tr>
  </tbody>
</table>
<h4 id="NCICTRPAPIAuthenticationGuide-Headers.1">
  Headers
</h4>
<table>
  <colgroup>
    <col/>
    <col/>
  </colgroup>
  <tbody>
    <tr>
      <td colspan="1">
        Accept-Encoding
      </td>
      <td colspan="1">
        gzip, deflate, br
      </td>
    </tr>
    <tr>
      <td colspan="1">
        Connection
      </td>
      <td colspan="1">
        keep-alive
      </td>
    </tr>
    <tr>
      <td>
        Content-Type
      </td>
      <td>
        application/xml
      </td>
    </tr>
    <tr>
      <td>
        Accept
      </td>
      <td>
        text/plain
      </td>
    </tr>
    <tr>
      <td colspan="1">
        Accept
      </td>
      <td colspan="1">
        */*
      </td>
    </tr>
  </tbody>
</table>
<h4 id="NCICTRPAPIAuthenticationGuide-Authorization:.1">
  Authorization:
</h4>
<table>
  <colgroup>
    <col/>
    <col/>
  </colgroup>
  <tbody>
    <tr>
      <td colspan="1">
        Authorization Type
      </td>
      <td colspan="1">
        Bearer Token
      </td>
    </tr>
    <tr>
      <td>
        Token
      </td>
      <td>
        Access Token generated in step 3 above
      </td>
    </tr>
  </tbody>
</table>
<h4 id="NCICTRPAPIAuthenticationGuide-Body:">
  Body:
</h4>
 Expand source


&lt;tns:studySubjects xmlns:tns=&#34;gov.nih.nci.accrual.webservices.types&#34;
xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
xsi:schemaLocation=&#34;gov.nih.nci.accrual.webservices.types ../../src/resources/ws.xsd &#34;&gt;
&lt;tns:studySubject&gt;
&lt;tns:identifier&gt;SU001&lt;/tns:identifier&gt;
&lt;tns:birthDate&gt;2002-01-01&lt;/tns:birthDate&gt;
&lt;tns:gender&gt;Female&lt;/tns:gender&gt;
&lt;tns:race&gt;Black or African American&lt;/tns:race&gt;
&lt;tns:ethnicity&gt;Not Hispanic or Latino&lt;/tns:ethnicity&gt;
&lt;tns:country&gt;USA&lt;/tns:country&gt;
&lt;tns:zipCode&gt;22201&lt;/tns:zipCode&gt;
&lt;tns:registrationDate&gt;2014-01-01&lt;/tns:registrationDate&gt;
&lt;tns:methodOfPayment&gt;MEDICAID_AND_MEDICARE&lt;/tns:methodOfPayment&gt;
&lt;tns:disease codeSystem=&#34;ICD9&#34;&gt;861.20&lt;/tns:disease&gt;
&lt;/tns:studySubject&gt;
&lt;/tns:studySubjects&gt;
<h2 id="NCICTRPAPIAuthenticationGuide-ErrorCodesfortheOktaAPI">
  Error Codes for the Okta API
</h2>
<table>
  <colgroup>
    <col/>
    <col/>
    <col/>
  </colgroup>
  <tbody>
    <tr>
      <td>
        Error
      </td>
      <td>
        Code
      </td>
      <td>
        Message
      </td>
    </tr>
    <tr>
      <td>
        Invalid Client Id
      </td>
      <td>
        401
      </td>
      <td>
        {    &#34;errorCode&#34;: &#34;invalid_client&#34;,    &#34;errorSummary&#34;: &#34;Invalid value for &#39;client_id&#39; parameter.&#34;,    &#34;errorLink&#34;: &#34;invalid_client&#34;,    &#34;errorId&#34;: &#34;oaejDJuWCiRTQeH8n6WG2116A&#34;,    &#34;errorCauses&#34;: []}
      </td>
    </tr>
    <tr>
      <td>
        Invalid Client Secret
      </td>
      <td>
        401
      </td>
      <td>
        {    &#34;error&#34;: &#34;invalid_client&#34;,    &#34;error_description&#34;: &#34;The client secret supplied for a confidential client is invalid.&#34;}
      </td>
    </tr>
    <tr>
      <td>
        Invalid User Credentials / Account Locked*
      </td>
      <td>
        400
      </td>
      <td>
        {    &#34;error&#34;: &#34;invalid_grant&#34;,    &#34;error_description&#34;: &#34;The credentials provided were invalid.&#34;}
      </td>
    </tr>
  </tbody>
</table>
<h2 id="NCICTRPAPIAuthenticationGuide-PasswordRotation">
  Password Rotation
</h2>
The Client ID and Client Secret need to be updated on a yearly basis. Contact the CTRP Support to obtain a new Client ID / Client Secret combination.
<h2 id="NCICTRPAPIAuthenticationGuide-CTRPRESTservices">
  CTRP REST services
</h2>
See the following for additional details on the various CTRP web services:
<ul>
  <li>
    <a href="https://wiki.nci.nih.gov/pages/viewpage.action?pageId=341188460" rel="nofollow">
      NCI CTRP Trial Registration REST Service Guide
    </a>
  </li>
  <li>
    <a href="https://wiki.nci.nih.gov/pages/viewpage.action?pageId=341188461" rel="nofollow">
      NCI CTRP Accrual REST Service Guide
    </a>
  </li>
  <li>
    <a href="https://wiki.nci.nih.gov/pages/viewpage.action?pageId=341188462" rel="nofollow">
      NCI CTRP Participating Site REST Service Guide
    </a>
  </li>
</ul>