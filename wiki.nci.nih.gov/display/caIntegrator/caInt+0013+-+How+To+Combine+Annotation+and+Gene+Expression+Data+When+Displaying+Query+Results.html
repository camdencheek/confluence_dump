<h1 id="caInt0013HowToCombineAnnotationandGeneExpressionDataWhenDisplayingQueryResults-Problem:Howtocombineannotationandgeneexpressiondatawhendisplayingqueryresults">
  Problem: How to combine annotation and gene expression data when displaying query results
</h1>
Topic: caIntegrator UsageDate entered: 08/23/2011Release: Up to caIntegrator 1.3
<h2 id="caInt0013HowToCombineAnnotationandGeneExpressionDataWhenDisplayingQueryResults-Solution">
  Solution
</h2>
caIntegrator allows users to query studies by both clinical annotation data (i.e., subject age and gender) and by gene expression data (i.e., numerical reporter IDs representing gene expression levels). When displaying the results for a compound query, caIntegrator can display either the annotation data or the gene expression data individually, but it lacks the ability to display the two together side-by-side. This how-to guide presents two different workarounds for this limitation. The first, and less sophisticated workaround, involves manually exporting the annotation and expression data separately as spreadsheet files, then merging the two spreadsheets afterwards. The second workaround, only available with caIntegrator version 1.3 or later, involves visualizing the data in the form of color-coded maps via a newly added featured known as the Integrative Genomics Viewer (IGV).
<h3 id="caInt0013HowToCombineAnnotationandGeneExpressionDataWhenDisplayingQueryResults-QueryingtheData">
  Querying the Data
</h3>
First, let&#39;s do a sample query of a caIntegrator study to illustrate the limitations in displaying query results. In our example, the study we will query is entitled &#39;TCGA Ovarian&#39;, which is selected in the &#39;Public Studies&#39; drop-down list at the top of the caIntegrator home page. To start querying, click on the &#39;Search TCGA Ovarian&#39; link in the navigation menu at the left.
<img alt="Screenshot of caIntegrator home page illustrating how to begin sample query of a study" height="138" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav6519595e56b86e0e1f9a7a20824f3e9a.png?api=v2">
To begin a sample query of the &#39;TCGA Ovarian&#39; study (highlighted in red), click on the &#39;Search TCGA Ovarian&#39; link (highlighted in blue). Next, on the &#39;Search&#39; page, under the &#39;Criteria&#39; tab, select &#39;Gene Expression&#39; from the drop-down list, then click on the &#39;Add&#39; button to the right.
<img alt="Screenshot of &#39;Search&#39; page showing how to add Gene Expression as a search criterion" height="221" width="312" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavb91145bcd01f31b37b0d70a45999a84e.png?api=v2">
In the &#39;Gene Expression&#39; drop-down list that appears below, select &#39;Gene Name&#39;, then in the &#39;Gene Symbol&#39; field to its right, type in &#39;BRCA1&#39;, and in the &#39;Platform Name&#39; drop-down list, select the entry that begins with the phrase &#39;Agilent&#39;.
<img alt="Screenshot of &#39;Search&#39; page showing how to specify specific search criteria" height="127" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav680f3fc218d527926d66bdc78822db1c.png?api=v2">
Next, go back to the top drop-down list, and this time select &#39;patient&#39;, then click on the &#39;Add&#39; button again.
<img alt="Screenshot of &#39;Search&#39; page showing how to specify additional search criteria" height="119" width="290" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav8f0693c671fecc29ee61eb951b99e763.png?api=v2">
In the &#39;patient&#39; drop-down list that appears below, select &#39;Gender&#39;, then in the drop-down list to its right, select &#39;Female&#39;, and finally, click on the &#39;Run Query&#39; button at the bottom.
<img alt="Screenshot of &#39;Search&#39; page showing how to specify additional search criteria" height="186" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav5c21f8725ae97dec8ace8b0a359e0251.png?api=v2">
The results are displayed under the &#39;Query Results&#39; tab as a list of subject IDs who meet the specified criteria (i.e., female subjects with available expression data for the BRCA1 gene).
<img alt="Screenshot of &#39;Query Results&#39; tab showing list of subject IDs who met specified search criteria" height="182" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav8d90f53c6cc7ef44316d6f66f6b20534.png?api=v2">
You can customize these results by first clicking on the &#39;Results Type&#39; tab at the top. To show the annotation data in the results, first make sure that the &#39;Annotation&#39; button is selected under the &#39;Select Results Type&#39; heading, then check off &#39;gender&#39; in the scrollable list box under the &#39;patient&#39; heading, and finally, click on the &#39;Run Query&#39; button at the bottom.
<img alt="Screenshot of &#39;Results Type&#39; tab showing how to add annotation data to query results" height="543" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav45d21da43942a23eaddcba6434beb150.png?api=v2">
Now, the &#39;Query Results&#39; tab re-appears with updated results – namely, a new column headed &#39;Gender&#39; to the right of the &#39;Subject ID&#39; column.
<img alt="Screenshot of &#39;Query Results&#39; tab showing updated results including annotation data" height="285" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav2f4e733c357589f6643c9922d8561aa2.png?api=v2">
To show the gene expression data in the results, click back on the &#39;Results Type&#39; tab at the top, then select the &#39;Gene Expression&#39; button under &#39;Select Results Type&#39;, the &#39;Gene&#39; button next to &#39;Select Reporter Type&#39;, and the &#39;Genes in Columns&#39; button next to &#39;Select Results Orientation&#39;. Finally, click on the &#39;Run Query&#39; button at the bottom.
<img alt="Screenshot of &#39;Results Type&#39; tab showing how to add gene expression data to query results" height="237" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav7d3f73b95ec4f6550bdd1dc223c10ab4.png?api=v2">
The results are displayed under the &#39;Query Results&#39; tab as a list of subject IDs with available BRCA1 expression data, with the corresponding sample IDs and expression levels for each subject.
<img alt="Screenshot of &#39;Query Results&#39; tab showing list of subjects with available expression data" height="168" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavaf0fc08103915ad58e2014d4af52a314.png?api=v2">
<h3 id="caInt0013HowToCombineAnnotationandGeneExpressionDataWhenDisplayingQueryResults-Workaround1:ManuallyExportingSpreadsheets">
  Workaround 1: Manually Exporting Spreadsheets
</h3>
So far, we&#39;ve seen that caIntegrator can display annotation and gene expression query results individually, but not side-by-side. One workaround for this limitation is to manually export the annotation and expression data separately as spreadsheet files, then merge the two spreadsheets afterwards. To begin, let&#39;s go back to the &#39;Query Results&#39; tab for the annotation results type and click on the &#39;Export to CSV&#39; button at the bottom left.
<img alt="illustration of step" height="315" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavfe075777c67734344a64f2cbf2f35c47.png?api=v2">
A dialog will then appear prompting you whether you want to open or save the CSV file. Click on the &#39;Save File&#39; button, then click on &#39;OK&#39; below it.
<img alt="Screenshot of file dialog showing how to save exported CSV file" height="281" width="402" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav2b2bc02362051b46d045c2ff62220ee4.png?api=v2">
Another dialog will then appear prompting you for the name and location of the saved file. Choose a convenient location to save the file to from the drop-down list at the top, then enter &#39;AnnotationResults.csv&#39; for the file name and click on the &#39;Save&#39; button.
<img alt="Screenshot of dialog showing how to specify filename for exported CSV file" height="411" width="562" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavbeb77685905584eb8034bbba264d0e6a.png?api=v2">
Next, let&#39;s open the CSV file we just saved in a spreadsheet application. In this guide, we&#39;ll use Microsoft Excel 2003. A partial screenshot of the Excel window is shown below. The spreadsheet consists of two columns: &#39;Subject ID&#39; and &#39;Gender&#39;.
<img alt="Screenshot of Microsoft Excel window showing query results from exported CSV file." height="233" width="247" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav77d077d6af745eacd79ec0481dcfc9ea.png?api=v2">
Now, go back to the &#39;Query Results&#39; tab for the gene expression results type and click on the &#39;Export to CSV&#39; button at the bottom left.
<img alt="Screenshot of &#39;Query Results&#39; tab showing how to export gene expression query results to a CSV file" height="346" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav6e574f5f4ffac8754e49a9f214822457.png?api=v2">
Then, repeat the steps we followed previously to save the resulting CSV file as &#39;genomicResults.CSV&#39; and open it in Excel. A partial screenshot of the Excel window is shown below. The spreadsheet consists of four columns: &#39;Subject ID&#39;, &#39;Sample ID&#39;, &#39;Gene Name&#39;, and &#39;BRCA1&#39;. Since the &#39;Gene Name&#39; column is empty, we can delete it, leaving three columns.
<img alt="Screenshot of Microsoft Excel window showing gene expression query results from exported CSV file" height="250" width="381" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavefa8e7cc19c866dbcb5d1236de1423e3.png?api=v2">
Now, highlight the entire contents of the spreadsheet (527 rows total), then select &#39;Copy&#39; from the &#39;Edit&#39; menu.
<img alt="Screenshot of Microsoft Excel window showing how to highlight and copy query results from exported CSV file" height="335" width="304" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavec229598405f900c89ffb91253ca9cad.png?api=v2">
Finally, switch back to the &#39;AnnotationResults.csv&#39; spreadsheet, click on the empty cell to the right of the &#39;Gender&#39; column heading, and select &#39;Paste&#39; from the &#39;Edit&#39; menu.
<img alt="Screenshot of Microsoft Excel window showing how to merge annotation and gene expression query results into a single CSV file" height="318" width="278" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav81d2fc5a00be443b6f741ac13e715af1.png?api=v2">
The resulting spreadsheet should appear as in the screenshot below of the first ten rows:
<img alt="Screenshot of Microsoft Excel window showing merged query results in a single CSV file" height="188" width="460" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavcefb86189b820f87ca1a32942990988e.png?api=v2">
Finally, save the merged spreadsheet by selecting &#39;Save As&#39; from the &#39;File&#39; menu, then entering &#39;mergedQueryResults.csv&#39; as the file name in the &#39;Save As&#39; dialog and clicking on the &#39;Save&#39; button.
<img alt="Screenshot of Microsoft Excel &#39;Save As&#39; dialog showing how to save merged query results to a CSV file" height="159" width="322" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav0c17f75e8efb4a4ecf4b256a2b3627bd.png?api=v2">
<img alt="Screenshot of Microsoft Excel &#39;Save As&#39; dialog showing how to save merged query results to a CSV file" height="369" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav5205ce51c51815e83ebaf65ad35703f2.png?api=v2">
<h3 id="caInt0013HowToCombineAnnotationandGeneExpressionDataWhenDisplayingQueryResults-Workaround2:TheIntegratedGenomicsViewer(IGV)">
  Workaround 2: The Integrated Genomics Viewer (IGV)
</h3>
The other workaround for caIntegrator&#39;s limited options for displaying query results is a newly added featured known as the Integrative Genomics Viewer (IGV), which allows the annotation and expression data to be visualized side-by-side in the form of color-coded maps. To begin using the IGV, switch back to the &#39;Results Type&#39; tab on the &#39;Search TCGA Ovarian&#39; page and click on the &#39;Integrative Genomics Viewer&#39; button under the &#39;Select Results Type&#39; heading.
<img alt="Screenshot of &#39;Results Type&#39; tab showing Integrative Genomics Viewer&#39; option" height="88" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavd62dba8b7f64174ae2f508e22042ca5a.png?api=v2">
Next, check off &#39;gender&#39; in the scrollable list box under the &#39;patient&#39; heading, and finally, click on the &#39;View in Integrative Genomics Viewer&#39; button at the bottom.
<img alt="Screenshot of annotation options to choose from when displaying Integrative Genomics Viewer options" height="512" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddava57ff9133864861b54f4e96145715182.png?api=v2">
NOTE: Before you launch the IGV, make sure you have version 6 or later of the Java Runtime Environment (JRE) installed on your machine. The JRE can be downloaded from the Oracle Web site at
<a href="http://www.oracle.com/technetwork/java/javase/downloads/jre-6u27-download-440425.html" rel="nofollow">
  http://www.oracle.com/technetwork/java/javase/downloads/jre-6u27-download-440425.html
</a>
Now, a new window will open in your Web browser entitled &#39;Integrative Genomics Viewer&#39;. Click on the blue link entitled &#39;Launch Integrative Genomics Viewer&#39;.
<img alt="Screenshot of Integrative Genomics Viewer pop-up window with link to launch the Viewer" height="209" width="495" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavb75e4da64c879beed6471c154de8177b.png?api=v2">
Assuming that you have the JRE properly installed, you should now see a dialog entitled &#39;Opening igv.jnlp&#39;. Make sure that the &#39;Open with&#39; button is selected, then click on the &#39;OK&#39; button at the bottom to launch the IGV.
<img alt="Screenshot of Web browser download dialog showing option to launch Integrative Genomics Viewer" height="281" width="402" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddavce26d7a10d45775b4fbd3cebe707b8f2.png?api=v2">
Depending on how the JRE is configured on your machine, you may see a dialog entitled &#39;Warning – Security&#39; stating, &#39;The application&#39;s digital signature cannot be verified. Do you want to run the application?&#39; If this is the case, simply click on the &#39;Run&#39; button at the bottom to continue.
<img alt="Screenshot of Java security warning dialog" height="295" width="515" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav781f7004156dd7fa88dc0e97b3a2e72c.png?api=v2">
The main IGV window is shown below. The application is complex and thus its documentation is beyond the scope of this tutorial. For an in-depth tutorial, visit the official IGV Web site, hosted by the Broad Institute of Harvard and MIT, at
<a href="http://www.broadinstitute.org/igv/QuickStart" rel="nofollow">
  http://www.broadinstitute.org/igv/QuickStart
</a>
.
<img alt="Screenshot of main Integrative Genomics Viewer window" height="431" width="575" src="https://wiki.nci.nih.gov/download/attachments/embedded-page/caIntegrator/caInt%200013%20-%20How%20To%20Combine%20Annotation%20and%20Gene%20Expression%20Data%20When%20Displaying%20Query%20Results/worddav101b6005be60239d5393fbb937f06381.png?api=v2">
<h2 id="caInt0013HowToCombineAnnotationandGeneExpressionDataWhenDisplayingQueryResults-Haveacomment?">
  Have a comment?
</h2>
Please leave your comment in the
<a href="https://cabig-kc.nci.nih.gov/Molecular/forums/viewforum.php?f=23&amp;sid=5d0023efa82739d1127556a15b85311c" rel="nofollow">
  caIntegrator End User Forum
</a>
.